<!DOCTYPE html>
<script type="text/javascript" src="https://d3js.org/d3.v4.min.js"></script>
<html>

<body onload='drawChart1()'>


<table>
 <tr>
  <td>
    <h1>
	<div id="title_narrative">New York - Covid 2019</div>
    </td>
   </h1>
 </tr>
 <tr>
  <td><h2><div id="scene3_title">Let's break the data by some dimensions:</div></h2></td>
 </tr>
 <tr>
  <td>
   <div id="scene3_info_top">
     Data:
  <ul>
   <li><p>Cumulative since the start of the outbreak</p></li>
   <li><p>Per 100,000 people by corresponding dimension</p></li>
   <li><p>Poverty groups are defined according to Federal Poverty Threshold (FPT)</p></li>
  </ul>
  </div>
  </td>
 </tr>
 <tr>
  <td>
     <button value = "by Sex" type = "button" onclick = "bringContent('area_chart1')"> by Sex </button>
     <button value = "by Race" type = "button" onclick = "bringContent('area_chart2')"> by Race </button>
     <button value = "by Age" type = "button" onclick = "bringContent('area_chart3')"> by Age </button>
     <button value = "by Poverty" type = "button" onclick = "bringContent('area_chart4')"> by Poverty </button>
  </td>
 </tr>
 <tr>
    <td><br><br><center><b><div id="area_chart1_title">chart 1 title</div></b></center></br></br></td>
 </tr>
  <tr>
    <td><div id="area_chart1"></div></td>
 </tr>

<tr>
  <td>
   <br>
   <div id="scene3_source">Source = <a href="https://github.com/nychealth/coronavirus-data" target="_blank">NYC Health Department</a></div>
  </br>
  </td>
 </tr>
 <tr>
  <td>
   <div id="scene3_next_page">
	<button onclick="window.location.href='https://joker2025.github.io/NY_Covid_2020/index.html';">
      Home Page
    </button>
   </div>
   </td>
 </tr>
</table>

<script>

function bringContent(elementID) { 

//clear content of the DIV
document.getElementById("area_chart1").innerHTML = ""; 

//bring corresponding chart based on the button
if (elementID === "area_chart1"){
 drawChart1();
}else if (elementID === "area_chart2"){
  drawChart2();  
}else if (elementID === "area_chart3"){
  drawChart3();
}
else{
  drawChart4();
}
}; 

// Set the dimensions of the SVG
var	margin = {top: 30, right: 20, bottom: 30, left: 50};
var	width = 600 - margin.left - margin.right;
var	height = 320 - margin.top - margin.bottom;

function drawChart1(){

//***********************************************************
// Chart #1 - by sex
//***********************************************************

//set title of the chart #1
document.getElementById("area_chart1_title").innerHTML = "Case count by Sex"; 


//add SVG for chart #1
var svg_chart1 = d3.select("#area_chart1")
 .append("svg")
  .attr("width", width + margin.left + margin.right)
  .attr("height", height + margin.top + margin.bottom);



//range = output for scales X and Y
//padding to allow space between bars
//scaleBand() in X because values are discrete
var xScale_chart1 = d3.scaleBand().range([0,width]).padding(0.4);
var yScale_chart1 = d3.scaleLinear().range([height,0]);


//add HTML group to include the axes and bar chart
var group_g = svg_chart1
		 .append("g")
		 .attr("transform", "translate(" + margin.left + "," + margin.top + ")"); 



//bring CSV data
const data = d3.csv('https://raw.githubusercontent.com/joker2025/narrative_visualization/master/scene3_by_sex.csv',function(error,data){
if(error) throw error;

//domain for X and Y
xScale_chart1.domain(data.map(function(d){ return d.SEX_GROUP;}));
yScale_chart1.domain([104000,d3.max(data,function(d){ return parseInt(d.CASE_COUNT);})]);


//add axis X to HTML group
group_g.append("g")
 .attr("transform","translate(0," + height + ")")
 .call(d3.axisBottom(xScale_chart1));

//add axis Y to HTML group
group_g.append("g")
  .call(d3.axisLeft(yScale_chart1).tickFormat(function(d){return d;})
  .ticks(10));

//draw bars
group_g.selectAll(".bar")
   .data(data)
   .enter()
   .append("rect")
   .attr("class", "bar")
   .attr("fill","#80b3ff")
   .attr("x", function(d) { return xScale_chart1(d.SEX_GROUP); })
   .attr("y", function(d) { return yScale_chart1(d.CASE_COUNT); })
   .attr("width", xScale_chart1.bandwidth())
   .attr("height", function(d) { return height - yScale_chart1(d.CASE_COUNT); });

});

}


function drawChart2(){
//***********************************************************
// Chart #2 - by race
//***********************************************************

//set title of the chart #2
document.getElementById("area_chart1_title").innerHTML = "Case count by Race"; 


//add SVG for chart #2
var svg_chart2 = d3.select("#area_chart1")
 .append("svg")
  .attr("width", width + margin.left + margin.right)
  .attr("height", height + margin.top + margin.bottom);




//range = output for scales X and Y
//padding to allow space between bars
//scaleBand() in X because values are discrete
var xScale_chart2 = d3.scaleBand().range([0,width]).padding(0.4);
var yScale_chart2 = d3.scaleLinear().range([height,0]);


//add HTML group to include the axes and bar chart
var group_g_chart2 = svg_chart2
		 .append("g")
		 .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


//bring CSV data

const data_chart2 = d3.csv('https://raw.githubusercontent.com/joker2025/narrative_visualization/master/scene3_by_race.csv',function(error,data){
if(error) throw error;


xScale_chart2.domain(data.map(function(d){ return d.RACE_GROUP;}));
yScale_chart2.domain([0,d3.max(data,function(d){ return parseInt(d.CASE_COUNT);})]);


//add axis X to HTML group
group_g_chart2.append("g")
 .attr("transform","translate(0," + height + ")")
 .call(d3.axisBottom(xScale_chart2));

//add axis Y to HTML group
group_g_chart2.append("g")
  .call(d3.axisLeft(yScale_chart2).tickFormat(function(d){return d;})
  .ticks(10));

//draw bars
group_g_chart2.selectAll(".bar")
   .data(data)
   .enter()
   .append("rect")
   .attr("class", "bar")
   .attr("fill","#8cd98c")
   .attr("x", function(d) { return xScale_chart2(d.RACE_GROUP); })
   .attr("y", function(d) { return yScale_chart2(d.CASE_COUNT); })
   .attr("width", xScale_chart2.bandwidth())
   .attr("height", function(d) { return height - yScale_chart2(d.CASE_COUNT); });

});
}

function drawChart3(){
//***********************************************************
// Chart #3 - by age
//***********************************************************

//set title of the chart #3
document.getElementById("area_chart1_title").innerHTML = "Case count by Age"; 


//add SVG for chart #3
var svg_chart3 = d3.select("#area_chart1")
 .append("svg")
  .attr("width", width + margin.left + margin.right)
  .attr("height", height + margin.top + margin.bottom);




//range = output for scales X and Y
//padding to allow space between bars
//scaleBand() in X because values are discrete
var xScale_chart3 = d3.scaleBand().range([0,width]).padding(0.4);
var yScale_chart3 = d3.scaleLinear().range([height,0]);


//add HTML group to include the axes and bar chart
var group_g_chart3 = svg_chart3
		 .append("g")
		 .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


//bring CSV data

const data_chart3 = d3.csv('https://raw.githubusercontent.com/joker2025/NY_Covid_2020/gh-pages/scene3_by_age_v2.csv',function(error,data){
if(error) throw error;


xScale_chart3.domain(data.map(function(d){ return d.AGE_GROUP;}));
yScale_chart3.domain([0,d3.max(data,function(d){ return parseInt(d.CASE_COUNT);})]);


//add axis X to HTML group
group_g_chart3.append("g")
 .attr("transform","translate(0," + height + ")")
 .call(d3.axisBottom(xScale_chart3));

//add axis Y to HTML group
group_g_chart3.append("g")
  .call(d3.axisLeft(yScale_chart3).tickFormat(function(d){return d;})
  .ticks(10));

//draw bars
group_g_chart3.selectAll(".bar")
   .data(data)
   .enter()
   .append("rect")
   .attr("class", "bar")
   .attr("fill","#ffb366")
   .attr("x", function(d) { return xScale_chart3(d.AGE_GROUP); })
   .attr("y", function(d) { return yScale_chart3(d.CASE_COUNT); })
   .attr("width", xScale_chart3.bandwidth())
   .attr("height", function(d) { return height - yScale_chart3(d.CASE_COUNT); });

});
}


function drawChart4(){
//***********************************************************
// Chart #4 - by age
//***********************************************************

//set title of the chart #4
document.getElementById("area_chart1_title").innerHTML = "Case count by Poverty"; 


//add SVG for chart #3
var svg_chart4 = d3.select("#area_chart1")
 .append("svg")
  .attr("width", width + margin.left + margin.right)
  .attr("height", height + margin.top + margin.bottom);




//range = output for scales X and Y
//padding to allow space between bars
//scaleBand() in X because values are discrete
var xScale_chart4 = d3.scaleBand().range([0,width]).padding(0.4);
var yScale_chart4 = d3.scaleLinear().range([height,0]);


//add HTML group to include the axes and bar chart
var group_g_chart4 = svg_chart4
		 .append("g")
		 .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


//bring CSV data

const data_chart4 = d3.csv('https://raw.githubusercontent.com/joker2025/NY_Covid_2020/gh-pages/scene3_by_poverty.csv',function(error,data){
if(error) throw error;


xScale_chart4.domain(data.map(function(d){ return d.POVERTY_GROUP;}));
yScale_chart4.domain([0,d3.max(data,function(d){ return parseInt(d.CASE_COUNT);})]);


//add axis X to HTML group
group_g_chart4.append("g")
 .attr("transform","translate(0," + height + ")")
 .call(d3.axisBottom(xScale_chart4));

//add axis Y to HTML group
group_g_chart4.append("g")
  .call(d3.axisLeft(yScale_chart4).tickFormat(function(d){return d;})
  .ticks(10));

//draw bars
group_g_chart4.selectAll(".bar")
   .data(data)
   .enter()
   .append("rect")
   .attr("class", "bar")
   .attr("fill","#ff99ff")
   .attr("x", function(d) { return xScale_chart4(d.POVERTY_GROUP); })
   .attr("y", function(d) { return yScale_chart4(d.CASE_COUNT); })
   .attr("width", xScale_chart4.bandwidth())
   .attr("height", function(d) { return height - yScale_chart4(d.CASE_COUNT); });

});
}

</script>

</body>
</html>
